# 24.4 GENERIC 内核选项（amd64）

理论上所有 GENERIC 内核选项都能在机器无关和 amd64/i386 机器相关选项中找到说明。详细选项列表及设备行说明可参考对应的 `NOTES` 文件。

GENERIC 本义是“通用的，一般的，普通的”。GENERIC 内核选项是 amd64 体系架构下所有镜像的默认构建选项（FreeBSD/amd64 通用内核配置文件），只不过 CURRENT（main 分支）会引入额外的调试选项。为了方便说明，不引入对于大多数非开发者无用的调试选项，我们选择 15.0-RELEASE（releng/15.0 分支）的 GENERIC 内核选项进行说明。

原文：[sys/amd64/conf/GENERIC](https://github.com/freebsd/freebsd-src/blob/releng/15.0/sys/amd64/conf/GENERIC)，版本：[u2f(4): Invert U2F_MAKE_UHID_ALIAS kernel build option](https://github.com/freebsd/freebsd-src/blob/releng/15.0/sys/amd64/conf/GENERIC)。全文近 400 行。


```sh
cpu		HAMMER
```

HAMMER 是 AMD K8 研发代号，即 Opteron（皓龙）& Athlon64（速龙）。

```sh
ident		GENERIC
```

这是内核的“标识”。通常应与内核的名称相同。将内核名称设置为 `GENERIC`。至少需要一行 `ident` 条目。

```sh
makeoptions	DEBUG=-g
```

构建带有 gdb(1) 调试符号的内核。

```sh
makeoptions	WITH_CTF=1
```

为支持 DTrace 运行 [ctfconvert(1)](https://man.freebsd.org/cgi/man.cgi?query=ctfconvert&sektion=1&format=html)（将调试数据转换为 CTF 数据）。

```sh
options 	SCHED_ULE
```

ULE 调度器。

```sh
options 	NUMA
```

非一致性内存架构（NUMA）支持。

```sh
options 	PREEMPTION
```

启用内核线程抢占。


```sh
options 	EXTERR_STRINGS
```

曾用名 `BLOAT_KERNEL_WITH_EXTERR`，内核扩展错误。参见 [Extended errors from kernel](https://reviews.freebsd.org/D50483)。

```sh
options 	VIMAGE
```

子系统虚拟化，例如 VNET。

```sh
options 	INET
```

IPv4 协议簇。IP 协议族是一组协议，分层于互联网协议（IP）传输层之上，并使用互联网地址格式。该协议族为 `SOCK_STREAM`、`SOCK_DGRAM` 和 `SOCK_RAW` 套接字类型提供协议支持；其中 `SOCK_RAW` 接口提供了对 IP 协议的访问。


```sh
options 	INET6
```

IPv6 协议簇。

```sh
options 	IPSEC_SUPPORT
```

允许通过 kldload 加载 ipsec 和 tcpmd5。


```sh
options 	IPSEC_OFFLOAD
```

内联 IPsec 卸载基础设施。


```sh
options 	ROUTE_MPATH
```

Multipath 路由支持

```sh
options 	FIB_ALGO
```

模块化 FIB 查找

```sh
options 	TCP_OFFLOAD
```

TCP 卸载

```sh
options 	TCP_BLACKBOX
```

增强的 TCP 事件日志

```sh
options 	TCP_HHOOK
```

TCP 的 hhook(9) 框架

```sh
options 	TCP_RFC7413
```

TCP 快速打开

```sh
options 	SCTP_SUPPORT
```

允许加载 SCTP KLD 模块

```sh
options 	KERN_TLS
```

TLS 发送和接收卸载

```sh
options 	FFS
```

伯克利快速文件系统

```sh
options 	SOFTUPDATES
```

启用 FFS 软更新支持

```sh
options 	UFS_ACL
```

访问控制列表支持

```sh
options 	UFS_DIRHASH
```

提升大目录的性能

```sh
options 	UFS_GJOURNAL
```

启用基于 gjournal 的 UFS 日志

```sh
options 	QUOTA
```

启用 UFS 磁盘配额

```sh
options 	MD_ROOT
```

可让 MD 可作为的根设备

```sh
options 	NFSCL
```

网络文件系统客户端

```sh
options 	NFSD
```

网络文件系统服务器

```sh
options 	NFSLOCKD
```

网络锁管理器

```sh
options 	NFS_ROOT
```

将 NFS 用作 `/`，依赖 `NFSCL`。

```sh
options 	MSDOSFS
```

MSDOS 文件系统

```sh
options 	CD9660
```

ISO 9660 文件系统

```sh
options 	PROCFS
```

Proc 进程文件系统（需要 PSEUDOFS）

```sh
options 	PSEUDOFS
```

伪文件系统框架

```sh
options 	TMPFS
```

高效的内存文件系统

```sh
options 	GEOM_RAID
```

软件 RAID 功能

```sh
options 	GEOM_LABEL
```

提供标签功能

```sh
options 	EFIRT
```

EFI 运行时服务支持

```sh
options 	COMPAT_FREEBSD32
```

兼容 i386 二进制

```sh
options 	COMPAT_FREEBSD4
```

兼容 FreeBSD 4

```sh
options 	COMPAT_FREEBSD5
```

兼容 FreeBSD 5

```sh
options 	COMPAT_FREEBSD6
```

兼容 FreeBSD 6

```sh
options 	COMPAT_FREEBSD7
```

兼容 FreeBSD 7

```sh
options 	COMPAT_FREEBSD9
```

兼容 FreeBSD 9

```sh
options 	COMPAT_FREEBSD10
```

兼容 FreeBSD 10

```sh
options 	COMPAT_FREEBSD11
```

兼容 FreeBSD 11

```sh
options 	COMPAT_FREEBSD12
```

兼容 FreeBSD 12

```sh
options 	COMPAT_FREEBSD13
```

兼容 FreeBSD 13

```sh
options 	COMPAT_FREEBSD14
```

兼容 FreeBSD 14

```sh
options 	SCSI_DELAY=5000
```

在探测 SCSI 前的延迟（毫秒）

```sh
options 	KTRACE
```

ktrace(1) 支持

```sh
options 	STACK
```

stack(9) 支持

```sh
options 	SYSVSHM
```

SYSV 风格共享内存

```sh
options 	SYSVMSG
```

SYSV 风格消息队列

```sh
options 	SYSVSEM
```

SYSV 风格信号量

```sh
options 	_KPOSIX_PRIORITY_SCHEDULING
```

POSIX P1003_1B 实时扩展

```sh
options 	PRINTF_BUFR_SIZE=128
```

防止 printf 输出交错

```sh
options 	KBD_INSTALL_CDEV
```

在 `/dev` 中生成 CDEV 条目

```sh
options 	HWPMC_HOOKS
```

hwpmc(4) 所需的内核钩子

```sh
options 	AUDIT
```

安全事件审计

```sh
options 	CAPABILITY_MODE
```

Capsicum 能力模式

```sh
options 	CAPABILITIES
```

Capsicum 能力

```sh
options 	MAC
```

TrustedBSD MAC 框架

```sh
options 	KDTRACE_FRAME
```

确保编译包含帧信息

```sh
options 	KDTRACE_HOOKS
```

内核 DTrace 钩子

```sh
options 	DDB_CTF
```

内核 ELF 链接器加载 CTF 数据

```sh
options 	INCLUDE_CONFIG_FILE
```

在内核中包含文件 `INCLUDE_CONFIG_FILE`。可以方便地引入更多存在于其他文本中的选项。

```sh
options 	RACCT
```

资源核算框架

```sh
options 	RACCT_DEFAULT_TO_DISABLED
```

默认设置 `kern.racct.enable=0`

```sh
options 	RCTL
```

资源限制


## 调试支持，总是需要

```
options 	KDB
```

启用内核调试器支持。

```sh
options 	KDB_TRACE
```

打印 Panic 的堆栈跟踪信息。

## 内核转储功能

```sh
options 	EKCD
```

支持加密内核转储。

```sh
options 	GZIO
```

gzip 压缩的内核与用户转储


```sh
options 	ZSTDIO
```

zstd 压缩的内核与用户转储

```sh
options 	DEBUGNET
```

debugnet 网络。

```sh
options 	NETDUMP
```

netdump(4) 客户端支持。

```sh
options 	NETGDB
```

netgdb(4) 客户端支持。

```sh
options 	SMP
```

默认生成支持 SMP（对称多处理器）的内核。

```sh
device		cpufreq
```

CPU 频率控制

## 总线支持

```
device		acpi
```

ACPI 支持。


```sh
device		smbios
```

smbios，System Management BIOS。系统管理 BIOS（System Management BIOS）概要支持。


```sh
options 	IOMMU
```

启用 IOMMU。

```sh
device		pci
```

通用 PCI/PCIe 总线驱动。

```sh
options 	PCI_HP
```

PCIe 原生热插拔

```
options 	PCI_IOV
```

PCI SR-IOV 支持。

```sh
options 	COMPAT_LINUXKPI
```

启用 Linux 内核编程接口。

```sh
options 	PPS_SYNC
```

启用内核 PLL 支持，以使用外部 PPS 信号，由 [x]ntpd(8) 监控。更多信息请参见 ntpd 文档：[http://www.eecis.udel.edu/~ntp](http://www.eecis.udel.edu/~ntp)


```sh
device		fdc
```

软盘驱动器


## ATA 控制器

```sh
device		ahci
```

兼容 AHCI 的 SATA 控制器

```sh
device		ata
```

传统 ATA/SATA 控制器

```sh
device		mvs
```

Marvell 88SX50XX/88SX60XX/88SX70XX/SoC SATA

```sh
device		siis
```

SiliconImage SiI3124/SiI3132/SiI3531 SATA


## SCSI 控制器

```sh
device		ahc
```

AHA2940 及板载 AIC7xxx 设备

```sh
device		ahd
```

AHA39320/29320 及板载 AIC79xx 设备

```sh
device		hptiop
```

Highpoint RocketRaid 3xxx 系列

```sh
device		isp
```

Qlogic 系列

```sh
#device		ispfw
```

QLogic HBA 的固件——通常作为模块

```sh
device		mpt
```

LSI-Logic MPT-Fusion

```sh
device		mps
```

LSI-Logic MPT-Fusion 2

```sh
device		mpr
```

LSI-Logic MPT-Fusion 3

```sh
device		mpi3mr
```

LSI-Logic MPT-Fusion 4

```sh
device		sym
```

NCR/Symbios Logic

```sh
device		isci
```

Intel C600 SAS 控制器

```sh
device		ocs_fc
```

Emulex 光纤通道适配器

```sh
device		pvscsi
```

VMware PVSCSI


## ATA/SCSI 外围设备


```sh
device		scbus
```

SCSI 总线（ATA/SCSI 必需）

```sh
device		ch
```

SCSI 介质切换器

```sh
device		da
```

直接访问设备（磁盘）

```sh
device		sa
```

顺序访问设备（磁带等）

```sh
device		cd
```

光盘

```sh
device		pass
```

直通设备（直接 ATA/SCSI 访问）

```sh
device		ses
```

机箱服务（SES 和 SAF-TE）

```sh
#device		ctl
```

CAM 目标层

## 通过 SCSI 子系统连接的 RAID 控制器

```sh
device		arcmsr
```

Areca SATA II RAID

```sh
device		ciss
```

Compaq Smart RAID 5*

```sh
device		ips
```

IBM (Adaptec) ServeRAID

```sh
device		smartpqi
```

Microsemi smartpqi 驱动

```sh
device		tws
```

LSI 3ware 9750 SATA+SAS 6Gb/s RAID 控制器

```sh
device		aac
```

RAID 控制器。Adaptec FSA RAID

```sh
device		aacp
```

aac 的 SCSI 直通（需要 CAM）

```sh
device		aacraid
```

PMC 出品的 Adaptec RAID

```sh
device		ida
```

Compaq Smart RAID

```sh
device		mfi
```

LSI MegaRAID SAS

```sh
device		mlx
```

Mylex DAC960 系列

```sh
device		mrsas
```

LSI/Avago MegaRAID SAS/SATA，支持 6Gb/s 和 12Gb/s

```sh
#device		pst
```

XXX 指针/整数警告（不知道什么意思，待查）。Promise Supertrak SX6000

## NVM Express (NVMe) 支持

```sh
device		nvme
```

基础 NVMe 驱动

```sh
device		nvd
```

将 NVMe 命名空间作为磁盘暴露，依赖 `nvme`


```sh
device 		ufshci			# UFS 主机控制器
```

通用闪存存储（UFS）主控接口支持。

```sh
device		vmd
```

Intel 卷管理设备（VMD）支持。


```sh
device		atkbdc
```

AT 键盘控制器。atkbdc0 同时控制着键盘和 PS/2 鼠标。

```sh
device		atkbd
```

AT 键盘

```sh
device		psm
```

PS/2 鼠标


```sh
device		kbdmux
```

键盘多路复用器


```sh
device		vga
```

VGA 显卡驱动

```sh
device		splash
```

启动画面和屏幕保护支持

```
device		sc
```

syscons 是传统控制台驱动，类似于 SCO 控制台

```sh
options 	SC_PIXEL_MODE
```

添加对光栅文本模式的支持

```sh
device		vt
device		vt_vga
device		vt_efifb
device		vt_vbefb
```

vt 是默认的视频控制台驱动。


```sh
device		agp
```

支持多种 AGP 芯片组。

## CardBus 桥

```sh
device		cbb
```

CardBus（yenta）桥

```sh
device		cardbus
```

CardBus（32 位）总线


## 串口（COM 端口）


```sh
device		uart
```

通用 UART 驱动。

## 并行端口

```sh
device		ppc
```

并行端口

```sh
device		ppbus
```

并行端口总线（必需）

```sh
device		lpt
```

打印机

```sh
device		ppi
```

并行端口接口设备

```sh
#device		vpo
```

需要 scbus 和 da

```sh
device		puc
```

多路 I/O 卡与多通道 UART

```sh
device		iflib
```

使用 iflib 基础设施的 PCI/PCI-X/PCIe 以太网网卡

```sh
device		em
```

Intel PRO/1000 千兆以太网系列

```sh
device		igc
```

Intel I225 2.5G 以太网

```sh
device		ix
```

Intel PRO/10GbE PCIE PF 以太网

```sh
device		ixv
```

Intel PRO/10GbE PCIE VF 以太网

```sh
device		ixl
```

Intel 700 系列物理功能

```sh
device		iavf
```

Intel 自适应虚拟功能

```sh
device		ice
```

Intel 800 系列物理功能

```sh
device		vmx
```

VMware VMXNET3 以太网

```sh
device		axp
```

AMD EPYC 集成网卡（需要 miibus）


## PCI 以太网卡

```sh
device		bxe
```

Broadcom NetXtreme II BCM5771X/BCM578XX 10GbE

```sh
device		le
```

AMD Am7900 LANCE 和 Am79C9xx PCnet

```sh
device		ti
```

Alteon Networks Tigon I/II 千兆以太网


```sh
device		mlx5
```

基础驱动。

Nvidia/Mellanox Connect-X 4 及之后型号，仅限以太网：

- 依赖 `COMPAT_LINUXKPI` 和 xz(4)
- mlx5ib 依赖 ibcore 基础设施，默认未内置


```sh
device		mlxfw
```

固件更新

```sh
device		mlx5en
```

以太网驱动


```sh
device		miibus
```

MII 总线支持。使用通用 MII 总线控制器代码的 PCI 以太网卡。

>**注意**
>
>请务必保留 `device miibus` 这行，以便使用这些网卡！


```sh
device		ae
```

Attansic/Atheros L2 快速以太网

```sh
device		age
```

Attansic/Atheros L1 千兆以太网

```sh
device		alc
```

Atheros AR8131/AR8132 以太网

```sh
device		ale
```

Atheros AR8121/AR8113/AR8114 以太网

```sh
device		bce
```

Broadcom BCM5706/BCM5708 千兆以太网

```sh
device		bfe
```

Broadcom BCM440x 10/100 以太网

```sh
device		bge
```

Broadcom BCM570xx 千兆以太网

```sh
device		cas
```

Sun Cassini/Cassini+ 和 NS DP83065 Saturn

```sh
device		dc
```

DEC/Intel 21143 及各种兼容芯片

```sh
device		et
```

Agere ET1310 10/100/千兆以太网

```sh
device		fxp
```

Intel EtherExpress PRO/100B (82557, 82558)

```sh
device		gem
```

Sun GEM/Sun ERI/Apple GMAC

```sh
device		jme
```

JMicron JMC250 千兆/ JMC260 快速以太网

```sh
device		lge
```

Level 1 LXT1001 千兆以太网

```sh
device		msk
```

Marvell/SysKonnect Yukon II 千兆以太网

```sh
device		nfe
```

nVidia nForce MCP 板载以太网

```sh
device		nge
```

NatSemi DP83820 千兆以太网

```sh
device		re
```

RealTek 8139C+/8169/8169S/8110S

```sh
device		rl
```

RealTek 8129/8139

```sh
device		sge
```

Silicon Integrated Systems SiS190/191

```sh
device		sis
```

Silicon Integrated Systems SiS 900/SiS 7016

```sh
device		sk
```

SysKonnect SK-984x & SK-982x 千兆以太网

```sh
device		ste
```

Sundance ST201（D-Link DFE-550TX）

```sh
device		stge
```

Sundance/Tamarack TC9021 千兆以太网

```sh
device		vge
```

VIA VT612x 千兆以太网

```sh
device		vr
```

VIA Rhine, Rhine II

```sh
device		xl
```

3Com 3c90x（“Boomerang”，“Cyclone”）


## 无线网卡

```sh
device		wlan
```

802.11 支持

```sh
options 	IEEE80211_DEBUG
```

启用调试信息

```sh
options 	IEEE80211_SUPPORT_MESH
```

启用 802.11s 草案支持

```sh
device		wlan_wep
```

802.11 WEP 支持

```sh
device		wlan_tkip
```

802.11 TKIP 支持

```sh
device		wlan_ccmp
```

802.11 CCMP 支持

```sh
device		wlan_gcmp
```

802.11 GCMP 支持

```sh
device		wlan_amrr
```

AMRR 发送速率控制算法

```sh
device		ath
```

Atheros CardBus/PCI 网卡

```sh
device		ath_hal
```

Atheros CardBus/PCI 芯片支持

```sh
options 	AH_AR5416_INTERRUPT_MITIGATION
```

AR5416 中断缓解

```sh
device		ath_rate_sample
```

ath 的 SampleRate 发送速率控制

```sh
#device		bwi
```

Broadcom BCM430x/BCM431x 无线网卡

```sh
#device		bwn
```

Broadcom BCM43xx 无线网卡

```sh
device		ipw
```

Intel 2100 无线网卡

```sh
device		iwi
```

Intel 2200BG/2225BG/2915ABG 无线网卡

```sh
device		iwn
```

Intel 4965/1000/5000/6000 无线网卡

```sh
device		malo
```

Marvell Libertas 无线网卡

```sh
device		mwl
```

Marvell 88W8363 802.11n 无线网卡

```sh
device		ral
```

Ralink Technology RT2500 无线网卡

```sh
device		wpi
```

Intel 3945ABG 无线网卡


## 伪设备

```sh
device		crypto
```

核心加密支持

```sh
device		aesni
```

AES-NI OpenCrypto 模块

```sh
device		loop
```

网络回环

```sh
device		padlock_rng
```

VIA Padlock 随机数生成器

```sh
device		rdrand_rng
```

Intel Bull Mountain 随机数生成器

```sh
device		ether
```

以太网支持

```sh
device		vlan
```

802.1Q VLAN 支持

```sh
device		tuntap
```

数据包隧道

```sh
device		md
```

内存“磁盘”

```sh
device		gif
```

IPv6 和 IPv4 隧道

```sh
device		firmware
```

固件辅助模块

```sh
device		xz
```

lzma 解压


```
device		bpf  # 伯克利数据包过滤器
```

`bpf` 设备可启用伯克利数据包过滤器。启用它时需注意管理方面的影响！

>**注意**
>
>DHCP 依赖 `bpf`。


## USB 支持

```sh
options 	USB_DEBUG
```

启用 USB 调试信息

```sh
device		uhci
```

UHCI PCI->USB 接口

```sh
device		ohci
```

OHCI PCI->USB 接口

```sh
device		ehci
```

EHCI PCI->USB 接口（USB 2.0）

```sh
device		xhci
```

XHCI PCI->USB 接口（USB 3.0）

```sh
device		usb
```

USB 总线（必需）

```sh
device		usbhid
```

USB HID 传输

```sh
device		hkbd
```

HID 键盘

```sh
device		ukbd
```

USB 键盘

```sh
device		umass
```

磁盘/大容量存储——需要 scbus 和 da


## 音频支持

```sh
device		sound
```

通用声卡驱动（必需）

```sh
device		snd_cmi
```

CMedia CMI8338/CMI8738

```sh
device		snd_csa
```

Crystal Semiconductor CS461x/428x

```sh
device		snd_emu10kx
```

Creative SoundBlaster Live! 和 Audigy

```sh
device		snd_es137x
```

Ensoniq AudioPCI ES137x

```sh
device		snd_hda
```

Intel 高保真音频

```sh
device		snd_ich
```

Intel、NVidia 及其他 ICH AC'97 音频

```sh
device		snd_via8233
```

VIA VT8233x 音频


## MMC/SD

```sh
device		mmc
```

MMC/SD 总线

```sh
device		mmcsd
```

MMC/SD 存储卡

```sh
device		sdhci
```

通用 PCI SD 主控器


## VirtIO

```sh
device		virtio
```

通用 VirtIO 总线（必需）

```sh
device		virtio_pci
```

VirtIO PCI 设备

```sh
device		vtnet
```

VirtIO 以太网设备

```sh
device		virtio_blk
```

VirtIO 块设备

```sh
device		virtio_scsi
```

VirtIO SCSI 设备

```sh
device		virtio_balloon
```

VirtIO 内存气球设备


## Linux KVM 半虚拟化支持

```sh
device		kvm_clock
```

KVM 半虚拟化时钟驱动。


## HyperV 驱动及增强支持

```
device		hyperv
```

HyperV 驱动。

## Xen HVM 客户机优化

```sh
options 	XENHVM
```

Xen HVM 内核基础设施。

>**注意**
>
>XENHVM 依赖 xenpci 和 xentimer。它们必须同时存在或同时不存在。

```sh
device		xenefi
```

Xen EFI 定时器设备

```sh
device		xenpci
```

Xen HVM 虚拟机管理器服务驱动

```sh
device		xentimer
```

Xen x86 PV 定时器设备


## netmap(4) 支持

```sh
device		netmap
```

Netmap 提供了对受支持的网卡的发送/接收环路的直接访问


## evdev 接口

```sh
options 	EVDEV_SUPPORT
```

在传统驱动中启用 evdev 支持

```sh
device		evdev
```

输入事件设备支持

```sh
device		uinput
```

安装 /dev/uinput CDEV


## HID 支持

```sh
options 	HID_DEBUG
```

启用调试信息

```sh
device		hid
```

通用 HID 支持

```sh
device		hidbus
```

通用 HID 总线

```sh
options 	IICHID_SAMPLING
```

解决缺失 GPIO 中断支持的变通方法


## EFI 设备

```sh
device		efidev
```

EFI 伪设备

```sh
device		efirtc
```

EFI 实时时钟



