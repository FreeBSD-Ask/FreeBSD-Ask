# 27.2 NetBSD 安装示例与图解

## 下载 NetBSD

NetBSD 下载地址：

- 面向虚拟机：[https://cdn.netbsd.org/pub/NetBSD/NetBSD-10.1/images/NetBSD-10.1-amd64.iso](https://cdn.netbsd.org/pub/NetBSD/NetBSD-10.1/images/NetBSD-10.1-amd64.iso)
- 面向物理机：[https://cdn.netbsd.org/pub/NetBSD/NetBSD-10.1/images/NetBSD-10.1-amd64-install.img.gz](https://cdn.netbsd.org/pub/NetBSD/NetBSD-10.1/images/NetBSD-10.1-amd64-install.img.gz)

## 安装图解

以下示例演示了在 VMware Workstation Pro 17 中使用 `NetBSD-10.1-amd64.iso` 进行的 UEFI、GPT 搭配 SATA 安装过程。


>**警告**
>
>若在 VMware Workstation Pro 17 虚拟机中安装 `NetBSD-10.1-amd64.iso`，NVMe 不受支持，可能导致系统卡住、无法卸载 DVD 或无法重启等问题。建议 CPU 数量不要过多，经测试 4 个 CPU 可正常使用。

回车启动系统。

![install NetBSD](../.gitbook/assets/nb1.png)

回车选择英文安装。

![install NetBSD](../.gitbook/assets/nb2.png)

保持键盘布局为默认设置，然后按回车。

![install NetBSD](../.gitbook/assets/nb3.png)

选择安装到硬盘上。回车。

![install NetBSD](../.gitbook/assets/nb4.png)

开始分区操作时，选择 `Yes` 并按回车。

![install NetBSD](../.gitbook/assets/nb5.png)

选择要安装 NetBSD 的硬盘。

![install NetBSD](../.gitbook/assets/nb6.png)


选择使用 GPT 分区表。

![install NetBSD](../.gitbook/assets/nb7.png)

设置分区大小。回车。

![install NetBSD](../.gitbook/assets/nb8.png)

确认分区大小设置，回车。

![install NetBSD](../.gitbook/assets/nb9.png)

确认分区大小设置，回车。

![install NetBSD](../.gitbook/assets/nb10.png)

确认写入分区信息到硬盘，选择 OK 后按回车。

![install NetBSD](../.gitbook/assets/nb11.png)

选择默认的完整安装（Full installation），然后按回车。

![install NetBSD](../.gitbook/assets/nb12.png)

选择安装源，本示例选择 DVD，然后按回车。

![install NetBSD](../.gitbook/assets/nb13.png)

开始安装……等待。

![install NetBSD](../.gitbook/assets/nb14.png)

回车以继续。


![install NetBSD](../.gitbook/assets/nb16.png)

设置 `root` 用户的密码。


![install NetBSD](../.gitbook/assets/nb17.png)

接下来将逐项进行系统配置。

>**警告**
>
>以下界面显示的是默认设置，需要根据实际情况进行修改，不建议直接使用默认值。

![install NetBSD](../.gitbook/assets/nb17-2.png)

首先进行配置项 `a`：网络设置，选择要使用的网卡。

![install NetBSD](../.gitbook/assets/nb18.png)

选择自动配置网络。

![install NetBSD](../.gitbook/assets/nb20.png)

确认网络自动配置设置。

![install NetBSD](../.gitbook/assets/nb21.png)

输入系统主机名和 DNS 域名。

![install NetBSD](../.gitbook/assets/nb22.png)

确认网络设置是否正确，然后选择 `Yes`。

![install NetBSD](../.gitbook/assets/nb23.png)

确认网络配置，并将设置写入系统。

![install NetBSD](../.gitbook/assets/nb24.png)

配置 `b` 时区。选择 `Asia`（亚洲）

![install NetBSD](../.gitbook/assets/nb25.png)

选择 `Asia/Shanghai`（北京时间）

![install NetBSD](../.gitbook/assets/nb26.png)

确认时区设置后，按回车退出该界面（Exit）。

![install NetBSD](../.gitbook/assets/nb27.png)

配置项 `e`：安装 `pkgin` 包管理器，直接按回车以继续。

![install NetBSD](../.gitbook/assets/nb29.png)

开始安装……

![install NetBSD](../.gitbook/assets/nb30.png)

安装完毕，按回车退出该界面。

![install NetBSD](../.gitbook/assets/nb31.png)

配置项 `f`：安装 `pkgsrc` 包管理器，直接按回车开始安装。


![install NetBSD](../.gitbook/assets/nb32.png)

等待安装……

![install NetBSD](../.gitbook/assets/nb33.png)

配置项 `o`：添加普通用户。输入用户名后按回车，再按回车将用户加入 `wheel` 组。


![install NetBSD](../.gitbook/assets/nb34.png)

选择普通用户的 Shell 类型。

![install NetBSD](../.gitbook/assets/nb35.png)

设置普通用户的密码。

![install NetBSD](../.gitbook/assets/nb36.png)

配置参数：

- `g`：sshd 远程服务
- `h`：打开时间同步
- `i`：开机校对时间
- `j`：mDNS
- `k`：xdm 图形界面
- `l`：磁盘加密模块。
- `m`：LVM（logical volume management）逻辑卷管理器
- `n`：软 RAID。

请根据需要开启。

![install NetBSD](../.gitbook/assets/nb37.png)

结束安装。

![install NetBSD](../.gitbook/assets/nb38.png)

安装完成。

![install NetBSD](../.gitbook/assets/nb38-1.png)

输入命令 `reboot` 重启系统。

![install NetBSD](../.gitbook/assets/nb38-2.png)

开机了！

![install NetBSD](../.gitbook/assets/nb39.png)

输入用户名和密码登录系统：

![install NetBSD](../.gitbook/assets/nb40.png)

初始 xdm 系统界面：

![install NetBSD](../.gitbook/assets/nb41.png)

## 故障排除与未竟事项

影响安装的具体原因尚不明确。根据观察，使用 IDE 硬盘或较少的 CPU 数量并未出现类似问题，但当指定 CPU 数量为 16 时可能会出现问题。
