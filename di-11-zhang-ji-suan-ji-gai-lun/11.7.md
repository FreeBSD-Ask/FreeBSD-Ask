# 第 11.7 节 命令行基础

## 登录到 FreeBSD

当你安装 FreeBSD 后，如果一切正常，你应该会在屏幕上看到以下内容：

```sh
FreeBSD/amd64 (ykla) (ttyv0)

login:
```

我们将这个屏幕上呈现的界面称为 TTY（teletypewriter，电传打字机）或物理终端。

解释：
- `FreeBSD` 是操作系统名称；
- `amd64` 是体系架构，一般英特尔和 AMD 处理器都是 amd64，即 X86-64；
- `ykla` 是主机名，是在安装系统时你自己设置的；
- `ttyv0` 是指首个 TTY，你会发现计算机中大部分事物的序列都是以 0 打头的；
- `login:` 指示用户登录。

我们输入用户名和密码，以登录到系统：

```sh
FreeBSD/amd64 (ykla) (ttyv0)

login:root # 此处输入用户名，然后按回车键
password: # 此处输入密码，然后按回车键
Last login: Tue Mar 18 17:24:48 2025 from 3413e8b6b43f
FreeBSD 15.0-CURRENT (GENERIC) main-n275981-b0375f78e32a

Welcome to FreeBSD!

Release Notes, Errata: https://www.FreeBSD.org/releases/
Security Advisories:   https://www.FreeBSD.org/security/
FreeBSD Handbook:      https://www.FreeBSD.org/handbook/
FreeBSD FAQ:           https://www.FreeBSD.org/faq/
Questions List:        https://www.FreeBSD.org/lists/questions/
FreeBSD Forums:        https://forums.FreeBSD.org/

Documents installed with the system are in the /usr/local/share/doc/freebsd/
directory, or can be installed later with:  pkg install en-freebsd-doc
For other languages, replace "en" with a language code like de or fr.

Show the version of FreeBSD installed:  freebsd-version ; uname -a
Please include that output and any error messages when posting questions.
Introduction to manual pages:  man man
FreeBSD directory layout:      man hier

To change this login announcement, see motd(5).
root@ykla:~ #
```

祝贺你！你已经成功地登录到了 FreeBSD 操作系统。

>**注意**
>
>密码并不会被回显打印到屏幕上：一般我们输入密码时，屏幕上会显示 `******`。但是在 FreeBSD 中，凡是涉及密码的地方大都不会有任何显示，即使输入了密码屏幕上也是空白的，和没有任何输入是一个状态，就是什么也没有，输入后回车即可。

### 参考文献

- [What is TTY in Linux?](https://itsfoss.com/what-is-tty-in-linux/)，翻译在 [Linux 黑话解释：TTY 是什么？](https://linux.cn/article-14093-1.html)。



## 命令行格式

大部分命令行命令都应是有意义的，例如 `ls` 即 `list`（列出来）、`wget` 即通过 web（网络）来 `get`（下载）；罕有一些见名不知意的命令，比如 `fuck` 命令（可自动纠正拼写错误的命令）。

```sh
# 命令 选项  参数1       参数2
# ls   -l   /home/ykla /tmp
/home/ykla:
total 317
……省略一部分……
drwxr-xr-x  2 ykla ykla        2 Mar  9 20:45 下载
drwxr-xr-x  2 ykla ykla        2 Mar  9 20:45 公共
drwxr-xr-x  2 ykla ykla        2 Mar  9 20:45 图片
drwxr-xr-x  2 ykla ykla        2 Mar  9 20:45 文档
drwxr-xr-x  2 ykla ykla        2 Mar  9 20:45 桌面
drwxr-xr-x  2 ykla ykla        2 Mar  9 20:45 模板
drwxr-xr-x  2 ykla ykla        2 Mar  9 20:45 视频
drwxr-xr-x  2 ykla ykla        2 Mar  9 20:45 音乐

/tmp:
total 6
drwxrwxrwt  2 root    wheel  3 Mar 18 17:23 .ICE-unix
-r--r--r--  1 root    wheel 11 Mar 18 17:10 .X0-lock
-r--r--r--  1 ykla    wheel 11 Mar 18 17:23 .X10-lock
drwxrwxrwt  2 root    wheel  4 Mar 18 17:23 .X11-unix
drwxrwxrwt  2 root    wheel  2 Mar 18 17:10 .XIM-unix
drwxrwxrwt  2 root    wheel  2 Mar 18 17:10 .font-unix
```

现在，大部分命令均应遵从上面的方式（有所省略）。这是 [POSIX.1-2024](https://pubs.opengroup.org/onlinepubs/9799919799/) 规范所规定的。

我们需要注意英文和中文是不同的，中文不使用空格进行分割，而英文必须使用空格以示分别。故，命令行的每个部分中间应该有空格，即 ` `。空格的数量一般不受限制，但最少应该为一个，即 ` `。

>**思考题**
>
>如果不使用空格或某种方式（例如其他符号）对命令行进行分隔，那么软件该如何理解整个句子？比如：`ls-l/home/ykla/tmp`、`ls/`：
>
>```sh
>root@ykla:~ # ls-l/home/ykla/tmp
>-sh: ls-l/home/ykla/tmp: not found
>root@ykla:~ # ls/
>-sh: ls/: not found
>```
>
>可以看到，shell 会将整个句子当成一个可执行的命令去执行。

我们还需要知道，命令是不具有自动纠错功能的，哪怕只是打错了一个字母，少了一个数字，命令也绝不会执行成功。

## 命令的执行与中断

与 Windows 以及图形化界面的软件不同，绝大部分命令行程序在执行中是不会有任何进度提示的。通常只有以下两个结果：

- 成功执行：

```sh
root@ykla:~ # cp test /root/mydir/
root@ykla:~ #
```

- 执行中断：

```sh
root@ykla:~ # cp test9 /root/mydir/
cp: test9: No such file or directory
```

执行中断有很多可能的情形，以上只是其中一种（指定的文件或目录不存在）。

可以看到，只有当执行中断时，命令行才会有提示；若执行完毕，是不会有任何提示的。这种 Unix 设计哲学旨在保证终端输出的简洁性。

## Shell

我们的命令是运行在 shell 中的，通过 shell 与系统进行交互。

FreeBSD 默认的 shell 是 sh。基本符合 [IEEE 1003.1-2024](https://standards.ieee.org/ieee/1003.1/7700/) 中对 shell 的规范。

Linux 中常见的 shell 一般是 bash。MacOS 中的 shell 通常是 zsh。

>**注意**
>
>Linux 中也存在 sh，但是一般都是被软链接到了 bash 或其他 shell，她们都不是真正的 sh。
>
>```bash
>$ ls -l /bin/sh
>lrwxrwxrwx 1 root root 4  2月 25 23:19 /bin/sh -> dash
>```

### 快捷键

一般可以用 **Tab** 键补全命令。上箭头 **↑** 是查看上一条命令，下箭头 **↓** 是查看下一条命令。

```sh 
root@ykla:~ # lo # 若此时按 TAB 键，输出如下。可以再输一个字母再按一次 TAB 键看看
local                    localedef                login
local-unbound            locate                   logins
local-unbound-anchor     lock                     logname
local-unbound-checkconf  lockf                    look
local-unbound-control    lockstat                 lorder
local-unbound-setup      locktest                 lowntfs-3g
locale
```


