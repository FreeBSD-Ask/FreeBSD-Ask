# 第 29.5 节 安装 Hyprland

Hyprland 是 Wayland 的一个合成器，支持窗口透明、模糊、圆角等等，动画效果做的不错。

## 安装 Hyprland

```shell
# pkg ins xorg hyprland waybar-hyprland rofi wofi qt5-base qt6-base qt5-wayland qt6-wayland xdg-desktop-portal-hyprland hyprpicker swaybg mako dbus
```

- Xorg 软件包里面包含 Wayland。直接安装 wayland 的方法未经测试。
- waybar 为 hyprland 的菜单栏。
- rofi 和 wofi 是程序启动器
- mako 用于显示通知

## 安装 waybar 所需字体

```shell
# pkg ins nerd-fonts
```

- 注意还需要桌面所必需的字体，例如 wqy-fonts，

## 首次启动 Hyprland

**！重要**：设置环境变量才能成功启动。这里以 zsh 为默认 shell 作为示例：  
在.zprofile 里面写入`` export XDG_RUNTIME_DIR=/var/run/user/`id -u` ``<br>
启用 dbus：`sysrc=dbus_enable="YES"`  
重启`reboot`  
Ctrl+A|t+F2/3/4/5/6/8 随便找一个 tty 进入,执行`ck-launch-session Hyprland`，这会在`$HOME/.config/hypr`生成一个默认配置文件。

## 故障排除

如果启动失败，或者黑屏，请检查有没有把自己用户加入到 video,有没有安装显卡驱动，XDG_RUNTIME_DIR 环境变量有没有正确设置且生效。

## 配置

配置文件可以

```shell
fetch https://book.bsdcn.org/hyprland.zip
```

### 配置 hyprland.conf

文件位置：`/home/<username>/.config/hypr/hyprland.conf`  
1.首先找到开头的警告，把它注释掉
`# autogenerated = 1`  
2.设置 Super 键为 mod 键（根据个人习惯设置，也可以设置为 A|t 键等等）`$mainMod = SUPER`  
3.悬浮窗口和传统桌面环境中的行为类似，可以随意拖动到屏幕上的任何位置，可以用鼠标调节窗口大小。默认的配置文件中是按住 mod 键，然后鼠标左键按住悬浮窗口可以拖动窗口进行移动，而按住右键拖动窗口可以调节窗口的大小。设置默认悬浮的窗口：`windowrulev2 = float, title:QQ`  
4.如果你按照开头的命令，安装了 swaybg,你可以设置壁纸（别忘了修改成你自己的图片文件的路径）：`exec-once=swaybg -i "$HOME/Pictures/Wallpapers/2769378.jpg"`  
5.任务栏：`exec-once=waybar`

### 配置 kitty.conf

文件位置：`/home/<username>/.config/kitty/kitty.conf`

### 配置 waybar（任务栏）

waybar 的配置文件目录在主目录的.config/waybar 文件夹里面，包含一个 config.jsonc 文件，和一个 style.css.
可以参考使用示例配置文件的 waybar 文件夹。示例配置文件中需要安装 noto-enoji 字体才能正常显示，也可以改成自己想要的图标。

用 `ck-launch-session Hyprland` 启动。  
也可以指定配置文件`Hyprland -c <配置文件路径>`

提示：可以参考桌面章节实现 tty 登陆以后自动启动

## 参考文献

- [ArchLinux 下 Hyprland 配置指北 作者：ticks-tan](https://www.bilibili.com/read/cv22707313/)
